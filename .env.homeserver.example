# =============================================================================
# PaperTerrace Home Server Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control

# =============================================================================
# Database Configuration (Cloud SQL)
# =============================================================================
# Cloud SQL connection name format: PROJECT_ID:REGION:INSTANCE_NAME
CLOUD_SQL_CONNECTION_NAME=your-project:asia-northeast1:paperterrace-db

# Database credentials
DB_USER=paperterrace
DB_PASSWORD=your-secure-password
DB_NAME=paperterrace

# =============================================================================
# Google Cloud Storage
# =============================================================================
STORAGE_TYPE=gcs
GCS_BUCKET_NAME=paperterrace-papers

# Service account key file path (relative to docker-compose.yml)
# Place your service account JSON key at: ./secrets/sa-key.json

# =============================================================================
# Firebase Configuration
# =============================================================================
FIREBASE_PROJECT_ID=paperterrace-a12ad
FIREBASE_API_KEY=your-firebase-api-key
FIREBASE_AUTH_DOMAIN=paperterrace-a12ad.firebaseapp.com
FIREBASE_STORAGE_BUCKET=paperterrace-a12ad.appspot.com
FIREBASE_MESSAGING_SENDER_ID=your-messaging-sender-id
FIREBASE_APP_ID=your-app-id
FIREBASE_MEASUREMENT_ID=your-measurement-id

# =============================================================================
# AI Provider Configuration
# =============================================================================
AI_PROVIDER=gemini
OCR_MODEL=gemini-1.5-flash
GEMINI_API_KEY=your-gemini-api-key

# =============================================================================
# Inference Service Configuration
# =============================================================================
INFERENCE_SERVICE_URL=http://inference:8080
INFERENCE_SERVICE_TIMEOUT=200
SKIP_INFERENCE_SERVICE_WARMUP=false

# Translation model settings
TRANSLATION_BEAM_SIZE=5
TRANSLATION_REPETITION_PENALTY=1.4
TRANSLATION_NO_REPEAT_NGRAM_SIZE=3

# Layout analysis threshold
LAYOUT_THRESHOLD=0.9

# =============================================================================
# Cloudflare Tunnel
# =============================================================================
# Get this token from Cloudflare dashboard after creating a tunnel
# Run: cloudflared tunnel create paperterrace
CLOUDFLARE_TUNNEL_TOKEN=your-tunnel-token

# =============================================================================
# Redis Configuration
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_URL=redis://redis:6379/0

# =============================================================================
# Logging & Security
# =============================================================================
LOG_LEVEL=INFO
ACCESS_LOG_LEVEL=INFO
TRUSTED_PROXY=true

# =============================================================================
# Notes
# =============================================================================
# 1. Service Account Setup:
#    - Create a service account in Google Cloud Console
#    - Grant roles: Cloud SQL Client, Storage Object Admin
#    - Download JSON key and save to ./secrets/sa-key.json
#
# 2. Cloudflare Tunnel Setup:
#    - Install cloudflared and create a tunnel
#    - Set CLOUDFLARE_TUNNEL_TOKEN here or in your environment
#
# 3. K3s Deployment:
#    - Ensure kubectl is configured to your cluster
#    - Run 'task homeserver:deploy' to build and deploy
#
# 4. Model Files:
#    - Download translation models to /models/m2m100_ct2/ on the host
#    - Or adjust the volume mount in infrastructure/k8s/03-inference.yaml
